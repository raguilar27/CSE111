<!DOCTYPE html>

<html>

<head>
        <title>UserCase Diagram</title>



        <!-- Testing with similar format to that given in lecture-->
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

        <script>
           function populateSeason() {
              var selMaker = document.getElementById('maker');
              var selProd = document.getElementById('product');
              selProd.value = "All";
     
              const API_URL = 'http://127.0.0.1:8092/api/ucl';
              axios.get(`${API_URL}`)
                 .then(response => {
                    //console.log(response.data.data);
                    
                    for (x=0; x<response.data.data.length; x++) {
                       //console.log(response.data.data[x].maker);
     
                       option = document.createElement('option');
                       option.value = response.data.data[x].maker;
                       option.text = response.data.data[x].maker;
                       selMaker.appendChild(option);
                    }
                 })
                 .catch(error =>
                    console.error('populateMakers', error)
                 )
           }
     
           function runQuery() {
              var selMaker = document.getElementById('maker').value;
              var selProd = document.getElementById('product').value;
              //console.log(selMaker);
              //console.log(selProd);
     
              var result = document.getElementById('result');
              result.innerHTML = "";
     
              const API_URL = `http://127.0.0.1:8092/api/maker-prod/${selMaker}-${selProd}`;
              axios.get(`${API_URL}`)
                 .then(response => {
                    //console.log(response.data.data);
     
                    if (response.data.data.length == 0) {
                       return;
                    }
     
                    let thead = result.createTHead();
                    let row = thead.insertRow();
                    for (key in response.data.data[0]) {
                       //console.log(key);
     
                       let th = document.createElement("th");
                       let text = document.createTextNode(key);
                       th.appendChild(text);
                       row.appendChild(th);
                    }
                    
                    for (x=0; x<response.data.data.length; x++) {
                       //console.log(response.data.data[x].maker);
     
                       let row = result.insertRow();
                       for (k in response.data.data[x]) {
                          console.log(k);
     
                          let cell = row.insertCell();
                          let text = document.createTextNode(response.data.data[x][k]);
                          cell.appendChild(text);
                       }
                    }
                 })
                 .catch(error =>
                    console.error('runQuery', error)
                 )
           }
        </script>


        <!-- Ends here-->
</head>

<body>
<h1>What season would you like to view?</h1>
<body onload="populateSeason()">
        <label>Season:</label>
        <select name="season" id="season">
           <option value=''> Select </option>
        </select>


<h1>Do you want to see matches and standings from that season?</h1>
<!--  <p>You have picked matches and standings.</p>  -->
<!--  <button>Find</button>  -->
<button name="runQ" onclick="runQuery()">Find</button>

<h1>Do you want to see clubs that participated in that season?</h1>
<!--  <p>You have picked the clubs that participated.</p>  -->
<button>Find</button>


<h1>Do you want to see stats from that season?</h1>
<!--  <p>You have picked the to see the stats.</p>  -->
<button>Find</button>


<h1>Do you want to see the player stats?</h1>
<!-- <p>You have picked to see the player stats.</p>  -->
<button>Find</button>


<h1>Do you want to see the club stats?</h1>
<!--  <p>You have picked to see the club stats.</p>  -->
<button>Find</button>
</body>
</html>